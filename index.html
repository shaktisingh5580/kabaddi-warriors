'use client'

import React, { useState, useEffect, useRef } from 'react'
import { motion, AnimatePresence } from 'framer-motion'
import { Canvas, useFrame } from '@react-three/fiber'
import { Text, OrbitControls } from '@react-three/drei'
import { Button } from "@/components/ui/button"
import { Input } from "@/components/ui/input"
import { Menu, X } from 'lucide-react'

const navItems = [
  { name: 'About', href: '#about' },
  { name: 'Syllabus', href: '/chatbot' },
  { name: 'Event notifications', href: '/event-notification' },
  { name: 'Courses', href: '/courses' },
  { name: 'Articles', href: '/articles' },
  { name: 'Join Us', href: '#join' },
  { name: 'Explore SDC', href: 'https://studentdeveloperclub.tech/?i=2' },
]

const courses = [
  { name: 'Web Development Basics', description: 'HTML, CSS, JavaScript fundamentals' },
  { name: 'Python for Beginners', description: 'Learn Python programming from scratch' },
  { name: 'Data Structures & Algorithms', description: 'Essential CS concepts for interviews' },
  { name: 'Mobile App Development', description: 'Build apps for iOS and Android' },
  { name: 'Machine Learning Basics', description: 'Introduction to AI and ML concepts' },
]

const AnimatedText = ({ children }) => {
  return (
    <motion.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.5 }}
    >
      {children}
    </motion.div>
  )
}

const FloatingObject = () => {
  const mesh = useRef()
  useFrame((state, delta) => {
    mesh.current.rotation.x += delta * 0.2
    mesh.current.rotation.y += delta * 0.3
    mesh.current.position.y = Math.sin(state.clock.elapsedTime) * 0.2
  })

  return (
    <mesh ref={mesh}>
      <torusKnotGeometry args={[1, 0.3, 100, 16]} />
      <meshStandardMaterial color="white" wireframe />
    </mesh>
  )
}

const HeroCanvas = () => {
  return (
    <Canvas camera={{ position: [0, 0, 5] }}>
      <ambientLight intensity={0.5} />
      <pointLight position={[10, 10, 10]} />
      <FloatingObject />
      <OrbitControls enableZoom={false} />
      <Text
        position={[0, 1.5, 0]}
        fontSize={0.5}
        color="white"
        anchorX="center"
        anchorY="middle"
      >
        Programming for Losers
      </Text>
    </Canvas>
  )
}

export default function ProgrammingForLosers() {
  const [isMenuOpen, setIsMenuOpen] = useState(false)
  const [activeSection, setActiveSection] = useState('')

  useEffect(() => {
    const handleScroll = () => {
      const sections = document.querySelectorAll('section')
      let currentActiveSection = ''

      sections.forEach((section) => {
        const sectionTop = section.offsetTop
        const sectionHeight = section.clientHeight
        if (window.pageYOffset >= sectionTop - 200 && window.pageYOffset < sectionTop + sectionHeight - 200) {
          currentActiveSection = section.id
        }
      })

      setActiveSection(currentActiveSection)
    }

    window.addEventListener('scroll', handleScroll)
    return () => window.removeEventListener('scroll', handleScroll)
  }, [])

  return (
    <div className="bg-black text-white min-h-screen">
      <header className="fixed top-0 left-0 right-0 z-50 bg-black bg-opacity-80 backdrop-filter backdrop-blur-sm">
        <nav className="container mx-auto px-4 py-4 flex justify-between items-center">
          <motion.div
            initial={{ opacity: 0, x: -20 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ duration: 0.5 }}
            className="text-2xl font-bold"
          >
            PFL
          </motion.div>
          <div className="md:hidden">
            <Button variant="ghost" size="icon" onClick={() => setIsMenuOpen(!isMenuOpen)}>
              {isMenuOpen ? <X /> : <Menu />}
            </Button>
          </div>
          <AnimatePresence>
            {(isMenuOpen || window.innerWidth >= 768) && (
              <motion.div
                initial={{ opacity: 0, y: -20 }}
                animate={{ opacity: 1, y: 0 }}
                exit={{ opacity: 0, y: -20 }}
                transition={{ duration: 0.3 }}
                className={`${
                  isMenuOpen ? 'flex' : 'hidden'
                } md:flex flex-col md:flex-row absolute md:relative top-full left-0 right-0 bg-black md:bg-transparent p-4 md:p-0`}
              >
                {navItems.map((item) => (
                  <motion.a
                    key={item.name}
                    href={item.href}
                    className={`block md:inline-block px-4 py-2 hover:text-gray-300 transition-colors ${
                      activeSection === item.href.slice(1) ? 'text-white font-bold' : 'text-gray-400'
                    }`}
                    onClick={() => setIsMenuOpen(false)}
                    whileHover={{ scale: 1.05 }}
                    whileTap={{ scale: 0.95 }}
                  >
                    {item.name}
                  </motion.a>
                ))}
              </motion.div>
            )}
          </AnimatePresence>
        </nav>
      </header>

      <main>
        <section id="hero" className="h-screen flex items-center justify-center relative overflow-hidden">
          <div className="absolute inset-0">
            <HeroCanvas />
          </div>
          <motion.div
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.8 }}
            className="relative z-10 text-center px-4"
          >
            <AnimatedText>
              <h1 className="text-4xl md:text-6xl font-bold mb-4">
                Programming for Losers (PFL)
              </h1>
            </AnimatedText>
            <AnimatedText>
              <p className="text-xl mb-8">
                Where coding failures become programming triumphs. Join our student-led club of aspiring programmers and future tech leaders!
                <br /> We are integrated club with STUDENT DEVELOPER CLUB (SDC)
              </p>
            </AnimatedText>
            <div className="flex flex-wrap justify-center gap-4">
              {['Register Now', 'Join WhatsApp', 'SDC'].map((text, index) => (
                <motion.div
                  key={text}
                  initial={{ opacity: 0, y: 20 }}
                  animate={{ opacity: 1, y: 0 }}
                  transition={{ duration: 0.5, delay: index * 0.1 }}
                >
                  <Button
                    variant={index === 1 ? 'secondary' : 'default'}
                    whileHover={{ scale: 1.05 }}
                    whileTap={{ scale: 0.95 }}
                  >
                    {text}
                  </Button>
                </motion.div>
              ))}
            </div>
          </motion.div>
        </section>

        <motion.section
          id="about"
          initial={{ opacity: 0 }}
          whileInView={{ opacity: 1 }}
          transition={{ duration: 0.8 }}
          className="py-20"
        >
          <div className="container mx-auto px-4">
            <h2 className="text-3xl font-bold mb-8 text-center">About PFL</h2>
            <AnimatedText>
              <p className="text-lg mb-4">
                Programming for Losers (PFL) is a grassroots initiative started by a group of passionate first-year students. We're just a bunch of coding enthusiasts trying to create a supportive community outside of our formal college environment. Our goal? To connect with like-minded individuals who share our love for programming and technology.
              </p>
            </AnimatedText>
            <AnimatedText>
              <p className="text-lg">
                As an independent club, we're not affiliated with any college or institution. We're simply students helping students, learning together, and building a network that extends beyond our campus. Whether you're a coding newbie or a budding tech wizard, PFL is the place where we all start as 'losers' but grow together into winners.
              </p>
            </AnimatedText>
          </div>
        </motion.section>

        <motion.section
          id="mentorship"
          initial={{ opacity: 0 }}
          whileInView={{ opacity: 1 }}
          transition={{ duration: 0.8 }}
          className="py-20 bg-white text-black"
        >
          <div className="container mx-auto px-4">
            <h2 className="text-3xl font-bold mb-8 text-center">Peer Learning, Not Teaching</h2>
            <AnimatedText>
              <p className="text-lg">
                At PFL, we believe in the power of peer learning. We're all students here, learning and growing together. We share our experiences, help each other overcome coding challenges, and collaborate on projects. It's not about one person teaching another; it's about collective growth and mutual support.
              </p>
            </AnimatedText>
          </div>
        </motion.section>

        <motion.section
          id="opportunities"
          initial={{ opacity: 0 }}
          whileInView={{ opacity: 1 }}
          transition={{ duration: 0.8 }}
          className="py-20"
        >
          <div className="container mx-auto px-4">
            <h2 className="text-3xl font-bold mb-8 text-center">Opportunities</h2>
            <div className="grid md:grid-cols-2 gap-8">
              {['Project Collaborations', 'Skill Sharing Sessions'].map((item, index) => (
                <motion.div
                  key={item}
                  initial={{ opacity: 0, y: 20 }}
                  whileInView={{ opacity: 1, y: 0 }}
                  transition={{ duration: 0.5, delay: index * 0.1 }}
                  whileHover={{ scale: 1.05 }}
                  className="bg-white text-black p-6 rounded-lg shadow-lg"
                >
                  <h3 className="text-xl font-bold mb-4">{item}</h3>
                  <p>
                    {item === 'Project Collaborations'
                      ? 'Team up with fellow members on coding projects. Gain hands-on experience and build your portfolio while learning from peers.'
                      : 'Participate in regular skill-sharing meetups where members can present and learn about various programming topics and technologies.'}
                  </p>
                </motion.div>
              ))}
            </div>
          </div>
        </motion.section>

        <motion.section
          id="courses"
          initial={{ opacity: 0 }}
          whileInView={{ opacity: 1 }}
          transition={{ duration: 0.8 }}
          className="py-20 bg-white text-black"
        >
          <div className="container mx-auto px-4">
            <h2 className="text-3xl font-bold mb-8 text-center">Our Learning Tracks</h2>
            <AnimatedText>
              <p className="text-lg mb-8 text-center">
                While we're not a formal educational institution, we organize study groups and learning tracks based on member interests:
              </p>
            </AnimatedText>
            <div className="grid md:grid-cols-3 gap-8">
              {courses.map((course, index) => (
                <motion.div
                  key={course.name}
                  initial={{ opacity: 0, y: 20 }}
                  whileInView={{ opacity: 1, y: 0 }}
                  transition={{ duration: 0.5, delay: index * 0.1 }}
                  whileHover={{ scale: 1.05 }}
                  className="bg-black text-white p-6 rounded-lg shadow-lg"
                >
                  <h3 className="text-xl font-bold mb-4">{course.name}</h3>
                  <p>{course.description}</p>
                </motion.div>
              ))}
            </div>
          </div>
        </motion.section>

        <motion.section
          id="join"
          initial={{ opacity: 0 }}
          whileInView={{ opacity: 1 }}
          transition={{ duration: 0.8 }}
          className="py-20"
        >
          <div className="container mx-auto px-4 text-center">
            <h2 className="text-3xl font-bold mb-8">Join PFL Today</h2>
            <AnimatedText>
              <p className="text-lg mb-8">
                Ready to start your programming journey with a supportive community of fellow students? Fill the google form for our mailing list and be the first to know about upcoming meetups, projects, and learning opportunities.
              </p>
            </AnimatedText>
            <div className="flex flex-wrap justify-center gap-4">
              {['Register Now', 'Join WhatsApp Community', 'SDC'].map((text, index) => (
                <motion.div
                  key={text}
                  initial={{ opacity: 0, y: 20 }}
                  animate={{ opacity: 1, y: 0 }}
                  transition={{ duration: 0.5, delay: index * 0.1 }}
                >
                  <Button
                    variant={index === 1 ? 'secondary' : 'default'}
                    whileHover={{ scale: 1.05 }}
                    whileTap={{ scale: 0.95 }}
                  >
                    {text}
                  </Button>
                </motion.div>
              ))}
            </div>
          </div>
        </motion.section>
      </main>

      <footer className="bg-white text-black py-8">
        <div className="container mx-auto px-4 text-center">
          <p>&copy; 2024 Programming for Losers (PFL). All rights reserved. Not affiliated with any educational institution.</p>
        </div>
      </footer>
    </div>
  )
}
